<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tik Tac Toe Bolt</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="style.css">
      <link rel="manifest" href="manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Cal+Sans&display=swap" rel="stylesheet">
</head>
<body>
    <div class="game-container">
        <h1>Tik Tac Toe<span class="bolt-text"> Bolt... </span></h1>

        <div class="player-setup">
            <div class="player-input">
                <label for="player1">Player X:</label>
                <input type="text" id="player1" value="Player 1">
            </div>
            <div class="player-input">
                <label for="player2">Player O:</label>
                <input type="text" id="player2" value="Player 2">
            </div>
        </div>

        <div id="status-area" class="status">Player 1's Turn (X)</div>

        <div id="game-board" class="game-board" onclick="mouseclick2.play()">
            </div>

        <div class="controls">
            <button id="restart-btn" onmousedown="mouseclick1.play()">Restart Game</button>
            <button id="how-to-play-btn" onmousedown="mouseclick1.play()">How to Play</button>
        </div>
    </div>

    <div id="how-to-play-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn" onmousedown="mouseclick1.play()" onclick="hideModal('how-to-play-modal')">&times;</span>
            <h2>How to Play Tik Tac Toe Bolt</h2>
            <ul>
                <li>The game is played on a 3x3 grid.</li>
                <li>Player 1 is X, Player 2 is O. Players take turns placing their sign in an empty cell.</li>
                <li><strong>The Bolt Rule:</strong> Each player can only have **3** of their signs on the board at any time.</li>
                <li>When a player places their **4th** sign, their **oldest** sign (the 1st one they placed) disappears from the board.</li>
                <li>The first player to get 3 of their signs in a row (horizontally, vertically, or diagonally) wins.</li>
            </ul>
        </div>
    </div>

    <div id="winner-modal" class="modal hidden">
        <div class="modal-content winner-announcement">
             <span class="close-btn" onmousedown="mouseclick1.play()" onclick="hideModal('winner-modal')">&times;</span>
            <h2 id="winner-message"></h2>
            <p>Final Board State:</p>
            <div id="final-board-display" class="mini-board">
                </div>
            <button onmousedown="mouseclick1.play()" onclick="hideModal('winner-modal'); startGame();">Play Again?</button>
        </div>
    </div>
   <button id="add-button">Add to Home Screen</button>
   <div id="install-instructions">
Tap the <b>Share</b> icon and select <b>Add to Home Screen</b>.
</div>
    <footer>
            <h2>Developed by GTMDBR</h2>
    </footer>
   

    <script src="script.js"></script>
   <script src="register-service-worker.js"></script>
   <script>
   if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/service-worker.js')
      .then((registration) => {
        console.log('Service Worker registered:', registration);
      })
      .catch((error) => {
        console.error('Service Worker registration failed:', error);
      });
  });
}
let deferredPrompt;
const addButton = document.getElementById('add-button');
const installInstructions = document.getElementById('install-instructions');

// Detect iOS/Safari
const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;

// Check if the app is already installed
const isInstalled = window.matchMedia('(display-mode: standalone)').matches || 
window.navigator.standalone === true;

if (!isInstalled) {
// Handle Chromium-based browsers
window.addEventListener('beforeinstallprompt', (event) => {
event.preventDefault();
deferredPrompt = event;
addButton.style.display = 'block';
installInstructions.style.display = 'none'; // Hide instructions for Chromium
});

// Handle Safari/iOS
if (isIos && isSafari) {
addButton.style.display = 'block';
installInstructions.style.display = 'block'; // Show instructions for Safari
}
}

addButton.addEventListener('click', async () => {
if (deferredPrompt) {
// Chromium-based browsers: Trigger A2HS prompt
deferredPrompt.prompt();
const choiceResult = await deferredPrompt.userChoice;
if (choiceResult.outcome === 'accepted') {
console.log('User accepted the A2HS prompt');
} else {
console.log('User dismissed the A2HS prompt');
}
deferredPrompt = null;
addButton.style.display = 'none';
installInstructions.style.display = 'none';
} else if (isIos && isSafari) {
// Safari: Instructions are already shown, no further action needed
console.log('Safari: User clicked button, instructions visible');
}
});

// Log when the app is installed (not supported in Safari)
window.addEventListener('appinstalled', () => {
console.log('App was installed');
addButton.style.display = 'none';
installInstructions.style.display = 'none';
});
   </script>
</body>
</html>
